From 71f9ed81cd389b7af55308370907bcfd3f353dcd Mon Sep 17 00:00:00 2001
From: Jarek Jarcec Cecho <jarcec@apache.org>
Date: Thu, 7 Nov 2013 17:17:19 -0800
Subject: [PATCH 01/30] CLOUDERA-BUILD. Building against CDH dependencies.

---
 client/pom.xml                             |    2 +-
 common/pom.xml                             |    2 +-
 connector/connector-generic-jdbc/pom.xml   |    2 +-
 connector/connector-mysql-fastpath/pom.xml |    2 +-
 connector/connector-mysql-jdbc/pom.xml     |    2 +-
 connector/connector-sdk/pom.xml            |    4 +-
 connector/pom.xml                          |    2 +-
 core/pom.xml                               |    2 +-
 dist/pom.xml                               |    2 +-
 docs/pom.xml                               |    2 +-
 execution/mapreduce/pom.xml                |    2 +-
 execution/pom.xml                          |    2 +-
 pom.xml                                    |  104 ++++++++++++++++++++++++++--
 repository/pom.xml                         |    2 +-
 repository/repository-derby/pom.xml        |    2 +-
 server/pom.xml                             |    2 +-
 shell/pom.xml                              |    2 +-
 spi/pom.xml                                |    2 +-
 submission/mapreduce/pom.xml               |    2 +-
 submission/pom.xml                         |    2 +-
 test/pom.xml                               |    2 +-
 21 files changed, 118 insertions(+), 28 deletions(-)

diff --git a/client/pom.xml b/client/pom.xml
index 0423ddf..fb827f7 100644
--- a/client/pom.xml
+++ b/client/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/common/pom.xml b/common/pom.xml
index c87034c..848a9df 100644
--- a/common/pom.xml
+++ b/common/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/connector/connector-generic-jdbc/pom.xml b/connector/connector-generic-jdbc/pom.xml
index 48c320c..9b79096 100644
--- a/connector/connector-generic-jdbc/pom.xml
+++ b/connector/connector-generic-jdbc/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>connector</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.connector</groupId>
diff --git a/connector/connector-mysql-fastpath/pom.xml b/connector/connector-mysql-fastpath/pom.xml
index 3703173..69eb95c 100644
--- a/connector/connector-mysql-fastpath/pom.xml
+++ b/connector/connector-mysql-fastpath/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>connector</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.connector</groupId>
diff --git a/connector/connector-mysql-jdbc/pom.xml b/connector/connector-mysql-jdbc/pom.xml
index b1fb3bb..f36cf31 100644
--- a/connector/connector-mysql-jdbc/pom.xml
+++ b/connector/connector-mysql-jdbc/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>connector</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.connector</groupId>
diff --git a/connector/connector-sdk/pom.xml b/connector/connector-sdk/pom.xml
index d5b732f..c5ba2e5 100644
--- a/connector/connector-sdk/pom.xml
+++ b/connector/connector-sdk/pom.xml
@@ -24,12 +24,12 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>connector</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
   <artifactId>connector-sdk</artifactId>
-  <version>1.99.3</version>
+  <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   <name>Sqoop Connector SDK</name>
 
   <dependencies>
diff --git a/connector/pom.xml b/connector/pom.xml
index 94fb6e5..4d39903 100644
--- a/connector/pom.xml
+++ b/connector/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/core/pom.xml b/core/pom.xml
index f0365c4..e7dafa1 100644
--- a/core/pom.xml
+++ b/core/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/dist/pom.xml b/dist/pom.xml
index 6a6cbab..c9fc404 100644
--- a/dist/pom.xml
+++ b/dist/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/docs/pom.xml b/docs/pom.xml
index 0857212..45857b2 100644
--- a/docs/pom.xml
+++ b/docs/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/execution/mapreduce/pom.xml b/execution/mapreduce/pom.xml
index 775a32c..f38a33c 100644
--- a/execution/mapreduce/pom.xml
+++ b/execution/mapreduce/pom.xml
@@ -21,7 +21,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>execution</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.execution</groupId>
diff --git a/execution/pom.xml b/execution/pom.xml
index 507353a..8905b81 100644
--- a/execution/pom.xml
+++ b/execution/pom.xml
@@ -21,7 +21,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/pom.xml b/pom.xml
index fee9fe1..0dc2728 100644
--- a/pom.xml
+++ b/pom.xml
@@ -20,14 +20,14 @@ limitations under the License.
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <parent>
-    <groupId>org.apache</groupId>
-    <artifactId>apache</artifactId>
-    <version>9</version>
+    <groupId>com.cloudera.cdh</groupId>
+    <artifactId>cdh-root</artifactId>
+    <version>5.0.0-SNAPSHOT</version>  
   </parent>
 
   <groupId>org.apache</groupId>
   <artifactId>sqoop</artifactId>
-  <version>1.99.3</version>
+  <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   <description>Apache Sqoop</description>
   <name>Sqoop</name>
   <packaging>pom</packaging>
@@ -87,7 +87,51 @@ limitations under the License.
     <url>https://git-wip-us.apache.org/repos/asf?p=sqoop.git</url>
   </scm>
 
+  <repositories>
+    <repository>
+      <id>cdh.releases.repo</id>
+      <url>https://repository.cloudera.com/content/groups/cdh-releases-rcs</url>
+      <name>CDH Releases Repository</name>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+    <repository>
+      <id>cdh.snapshots.repo</id>
+      <url>https://repository.cloudera.com/content/repositories/snapshots</url>
+      <name>CDH Snapshots Repository</name>
+      <snapshots>
+        <enabled>true</enabled>
+      </snapshots>
+      <releases>
+        <enabled>false</enabled>
+      </releases>
+    </repository>
+    <repository>
+      <id>datanucleus</id>
+      <url>http://www.datanucleus.org/downloads/maven2</url>
+      <name>Datanucleus</name>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+    <repository>
+      <id>java.net repository</id>
+      <url>http://download.java.net/maven/2</url>
+      <snapshots>
+        <enabled>false</enabled>
+      </snapshots>
+    </repository>
+    <repository>
+      <id>cdh.thirdparty.repo</id>
+      <url>https://repository.cloudera.com/content/repositories/third-party</url>
+      <name>Cloudera Third Party Repository</name>
+      <snapshots><enabled>false</enabled></snapshots>
+    </repository>
+  </repositories>
+
   <properties>
+    <javaVersion>1.7</javaVersion>
     <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
     <maven.compile.source>1.6</maven.compile.source>
     <maven.compile.target>1.6</maven.compile.target>
@@ -96,7 +140,7 @@ limitations under the License.
     <commons-io.version>2.4</commons-io.version>
     <derby.version>10.8.2.2</derby.version>
     <hadoop.1.version>1.0.3</hadoop.1.version>
-    <hadoop.2.version>2.0.2-alpha</hadoop.2.version>
+    <hadoop.2.version>${cdh.hadoop.version}</hadoop.2.version>
     <guava.version>11.0.2</guava.version>
     <json-simple.version>1.1</json-simple.version>
     <junit.version>4.11</junit.version>
@@ -104,8 +148,8 @@ limitations under the License.
     <log4j.version>1.2.16</log4j.version>
     <servlet.version>2.5</servlet.version>
     <cargo.version>1.3.2</cargo.version>
-    <tomcat.major.version>6</tomcat.major.version>
-    <tomcat.minor.version>0.36</tomcat.minor.version>
+    <tomcat.major.version>${cdh.tomcat.major.version}</tomcat.major.version>
+    <tomcat.minor.version>${cdh.tomcat.minor.version}</tomcat.minor.version>
     <tomcat.version>${tomcat.major.version}.${tomcat.minor.version}</tomcat.version>
     <jdbc.mysql.version>5.1.23</jdbc.mysql.version>
     <jdbc.postgresql.version>9.1-901.jdbc4</jdbc.postgresql.version>
@@ -433,11 +477,54 @@ limitations under the License.
         <groupId>org.apache.rat</groupId>
         <artifactId>apache-rat-plugin</artifactId>
       </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-enforcer-plugin</artifactId>
+        <inherited>false</inherited>
+          <configuration>
+            <rules>
+              <requireMavenVersion>
+                <version>[3.0.0,)</version>
+              </requireMavenVersion>
+              <requireJavaVersion>
+                <version>[${javaVersion}.0,${javaVersion}.1000}]</version>
+              </requireJavaVersion>
+            </rules>
+          </configuration>
+          <executions>
+            <execution>
+              <id>clean</id>
+              <goals>
+                <goal>enforce</goal>
+              </goals>
+              <phase>pre-clean</phase>
+            </execution>
+            <execution>
+              <id>default</id>
+              <goals>
+                <goal>enforce</goal>
+              </goals>
+              <phase>validate</phase>
+            </execution>
+            <execution>
+              <id>site</id>
+              <goals>
+                <goal>enforce</goal>
+              </goals>
+              <phase>pre-site</phase>
+            </execution>
+        </executions>
+      </plugin>
     </plugins>
     <pluginManagement>
       <plugins>
         <plugin>
           <groupId>org.apache.maven.plugins</groupId>
+          <artifactId>maven-enforcer-plugin</artifactId>
+          <version>1.0</version>
+        </plugin>
+        <plugin>
+          <groupId>org.apache.maven.plugins</groupId>
           <artifactId>maven-compiler-plugin</artifactId>
           <version>2.3.2</version>
           <configuration>
@@ -467,6 +554,9 @@ limitations under the License.
                   <exclude>**.patch</exclude>
                   <exclude>patch-process/*</exclude>
                   <exclude>.metadata/</exclude>
+                  <exclude>cloudera/*</exclude>
+                  <exclude>*buildinfo</exclude>
+                  <exclude>**/*.patch</exclude>
                 </excludes>
               </configuration>
             </execution>
diff --git a/repository/pom.xml b/repository/pom.xml
index 13198d9..a8a035e 100644
--- a/repository/pom.xml
+++ b/repository/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/repository/repository-derby/pom.xml b/repository/repository-derby/pom.xml
index 1dc61b4..036507b 100644
--- a/repository/repository-derby/pom.xml
+++ b/repository/repository-derby/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>repository</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.repository</groupId>
diff --git a/server/pom.xml b/server/pom.xml
index 7abebfe..fb5d03c 100644
--- a/server/pom.xml
+++ b/server/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/shell/pom.xml b/shell/pom.xml
index 20a256a..b1576d1 100644
--- a/shell/pom.xml
+++ b/shell/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/spi/pom.xml b/spi/pom.xml
index 3495cad..42062b0 100644
--- a/spi/pom.xml
+++ b/spi/pom.xml
@@ -24,7 +24,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/submission/mapreduce/pom.xml b/submission/mapreduce/pom.xml
index c4aa0f6..c329299 100644
--- a/submission/mapreduce/pom.xml
+++ b/submission/mapreduce/pom.xml
@@ -21,7 +21,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache.sqoop</groupId>
     <artifactId>submission</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop.submission</groupId>
diff --git a/submission/pom.xml b/submission/pom.xml
index 0ca6346..789c634 100644
--- a/submission/pom.xml
+++ b/submission/pom.xml
@@ -21,7 +21,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
diff --git a/test/pom.xml b/test/pom.xml
index 2f5a276..4acd039 100644
--- a/test/pom.xml
+++ b/test/pom.xml
@@ -22,7 +22,7 @@ limitations under the License.
   <parent>
     <groupId>org.apache</groupId>
     <artifactId>sqoop</artifactId>
-    <version>1.99.3</version>
+    <version>1.99.3-cdh5.0.0-SNAPSHOT</version>
   </parent>
 
   <groupId>org.apache.sqoop</groupId>
-- 
1.7.0.4

